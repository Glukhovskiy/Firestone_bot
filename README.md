# Firestone Bot

Автоматический бот для игры Firestone, созданный с использованием MelonLoader.

## Описание

Firestone Bot автоматизирует выполнение повседневных задач в игре Firestone, включая сбор ресурсов, выполнение миссий, исследования и другие игровые активности.

## Возможности

### Основные модули:
- **Guild Expeditions** - Автоматическое участие в гильдейских экспедициях
- **Map Missions** - Выполнение миссий на карте с автоматическим определением типа и приоритизацией
- **Daily Tasks** - Сбор наград за ежедневные/еженедельные задания
- **Meteorite Research** - Автопокупка бонусов в библиотеке за метеориты
- **Firestone Research** - Исследование в библиотеке с приоритизацией
- **Mystery Box** - Сбор ежедневного подарка 
- **Check In** - Ежедневная регистрация
- **Oracle Rituals** - Ритуалы оракула
- **Oracle's Gift** - Дары оракула
- **Oracle Blessings** - Благословения оракула с приоритизацией
- **Upgrades** - Автоматические улучшения
- **Chests** - Открытие сундуков
- **Tanks** - Сбор наград и выполнение ежедневных миссий танков
- **Alchemy** - Сбор и запуск исследований алхимика за кровь дракона
- **Engineer** - Сбор ключей у инженера
- **Close Windows** - Периодическое закрытие всех открытых окон (каждые 10 минут)

## Установка

1. Убедитесь, что у вас установлен [MelonLoader](https://github.com/LavaGang/MelonLoader/releases/latest) для игры Firestone
2. Скопируйте [Fireston_bot.dll](https://github.com/Glukhovskiy/Firestone_bot/releases/latest) в папку `Mods` игры
3. Запустите игру

## Управление

### Горячие клавиши:
- **F5** - Включить/выключить бота
- **F7** - Включить/выключить модуль Chests
- **F8** - Включить/выключить режим отладки (визуальный отладчик с кликом мыши)

## Конфигурация

Настройки бота хранятся в файле `Mods/unified_config.json` в формате JSON. При первом запуске создается автоматически с настройками по умолчанию.

### Структура конфигурации:

```json
{
  "Bot": {
    "Enabled": true,
    "DebugEnabled": true,
    "GuildExpeditions": true,
    "MapMissions": true,
    "DailyTasks": true,
    "MeteoriteResearch": true,
    "FirestoneResearch": true,
    "MysteryBox": true,
    "CheckIn": true,
    "OracleRituals": true,
    "OraclesGift": true,
    "OracleBlessings": true,
    "Upgrades": true,
    "Chests": true,
    "Tanks": false,
    "Alchemy": true,
    "Engineer": true,
    "CloseWindows": false
  },
  "FirestoneResearch": {
    "1/12": 1,
    "2/2": 1,
    "1/6": 2
  },
  "OracleBlessings": {
    "11": 1,
    "0": 2,
    "6": 3
  },
  "MissionPriorities": {
    "scout": 1,
    "adventure": 2,
    "war": 3
  }
}
```

### Параметры Bot секции:
- `Enabled` - Общее включение/выключение бота
- `DebugEnabled` - Режим отладки
- Остальные параметры - включение/выключение конкретных модулей

## Настройка приоритетов

### Исследования Firestone

Приоритеты исследований настраиваются в секции `FirestoneResearch`:

```json
"FirestoneResearch": {
  "1/12": 1,  // tree1/research12 - Prestigious (престижный)
  "2/2": 1,   // tree2/research2 - Prestigious (престижный)
  "1/6": 2,   // tree1/research6 - Raining gold (золотой дождь)
  "2/5": 2,   // tree2/research5 - Raining gold (золотой дождь)
  "3/14": 2,  // tree3/research14 - Raining gold (золотой дождь)
  "2/1": 3    // tree2/research1 - All main attributes (все основные атрибуты)
}
```

### Благословения оракула

Приоритеты благословений настраиваются в секции `OracleBlessings`:

```json
"OracleBlessings": {
  "11": 1,  // Prestigious - Престижность
  "0": 2,   // Raining gold - Дождь из золота
  "6": 3,   // Damage specialization - Специализация бойца
  "8": 4,   // Precision - Точность
  "3": 5    // Energy heroes - Герои с энергией
}
```

### Приоритеты миссий

Приоритеты типов миссий настраиваются в секции `MissionPriorities`:

```json
"MissionPriorities": {
  "mysterybox": 0, // Таинственный ящик - наивысший приоритет
  "scout": 1,      // Разведка - высокий приоритет
  "adventure": 2,  // Приключения - средний приоритет
  "war": 3,        // Война - низкий приоритет
  "dragon": 4,     // Дракон
  "monster": 5,    // Монстр
  "naval": 6       // Морские - низший приоритет
}
```

### Правила приоритизации:
- **0** = высший приоритет (выполняется первым)
- **1-998** = обычные приоритеты (по возрастанию)
- **999** = отключено (не выполняется)
- Элементы не указанные в конфиге получают приоритет **998**

### Справочные секции:

В конфиге также присутствуют справочные секции `ResearchNames` и `BlessingNames` с описаниями всех доступных исследований и благословений для удобства настройки.

## Принцип работы

Бот работает циклически, последовательно выполняя активные модули в следующем порядке:

1. **Guild Expeditions** - Сбор наград и запуск новых экспедиций
2. **Map Missions** - Сбор активных наград, автоматическое определение типа миссий и запуск по приоритетам
3. **Daily Tasks** - Сбор наград за ежедневные и еженедельные задания
4. **Meteorite Research** - Покупка бонусов за метеориты
5. **Firestone Research** - Исследования по приоритетам из конфига
6. **Mystery Box** - Сбор ежедневного подарка
7. **Check In** - Ежедневная регистрация
8. **Oracle Rituals** - Ритуалы оракула
9. **Oracle's Gift** - Дары оракула
10. **Oracle Blessings** - Благословения по приоритетам из конфига
11. **Upgrades** - Автоматические улучшения
12. **Chests** - Открытие сундуков
13. **Tanks** - Танковые миссии и награды
14. **Alchemy** - Алхимические исследования
15. **Engineer** - Сбор ключей
16. **Close Windows** - Закрытие зависших окон

После завершения всех модулей цикл повторяется.

### Особенности модулей с приоритизацией:
- **Firestone Research**: Исследования выполняются в порядке приоритета из конфига
- **Oracle Blessings**: Благословения покупаются в порядке приоритета из конфига
- **Map Missions**: Автоматическое определение типа миссий по спрайтам иконок и запуск по приоритетам
- В логах отображаются найденные элементы с их приоритетами и описаниями

## Отладка

### Визуальный отладчик (F8):
- Клик мыши по элементам интерфейса показывает их пути и свойства
- Поиск UI элементов через Raycast
- Анализ компонентов и коллайдеров
- Детальное логирование всех действий бота

### Система состояний:
- Каждый сложный модуль использует конечный автомат состояний
- Таймеры ожидания между действиями для стабильности
- Обработка ошибок и восстановление состояния

## Архитектура

### Основные компоненты:
- **BotMain** - Главный класс с циклом выполнения модулей
- **ConfigManager** - Управление унифицированной конфигурацией
- **GameUtils** - Утилиты для работы с игровыми объектами
- **DebugManager** - Система отладки и логирования
- **Модули** - Отдельные классы для каждой игровой активности

### Технические особенности:
- Использование Il2Cpp для работы с Unity объектами
- Поиск UI элементов по иерархическим путям
- Симуляция пользовательских действий через события Unity
- Система приоритетов с автоматической сортировкой

## Безопасность

- Бот использует только стандартные игровые интерфейсы
- Не модифицирует игровые данные напрямую
- Работает через симуляцию пользовательских действий
- Не использует внешние библиотеки для взлома или модификации игры

## Требования

- Игра Firestone
- [MelonLoader](https://github.com/LavaGang/MelonLoader/releases/latest)
- .NET 6.0 (MelonLoader установит автоматически)
- Собранная [Fireston_bot.dll](https://github.com/Glukhovskiy/Firestone_bot/releases/latest)

## Поддержка

При возникновении проблем:
1. Проверьте логи MelonLoader в консоли игры
2. Убедитесь в корректности конфигурации `unified_config.json`
3. Используйте режим отладки (F8) для диагностики
4. Перезапустите игру с ботом
5. Проверьте совместимость версии MelonLoader с игрой

## Отказ от ответственности

Использование бота может нарушать правила игры. Используйте на свой страх и риск. Авторы не несут ответственности за возможные последствия использования бота.